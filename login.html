<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login Page</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript">
        var clevertap = { event: [], profile: [], account: [], onUserLogin: [], notifications: [], privacy: [] };
        clevertap.account.push({ "id": "WR7-899-766Z" });
        clevertap.privacy.push({ optOut: false });
        clevertap.privacy.push({ useIP: false });
        clevertap.dismissSpamControl = true;
        // Function to load CleverTap script
        function loadCleverTapScript() {
            var wzrk = document.createElement('script');
            wzrk.type = 'text/javascript';
            wzrk.async = true;
            wzrk.src = ('https:' == document.location.protocol ? 'https://d2r1yp2w7bby2u.cloudfront.net' : 'http://static.clevertap.com') + '/js/clevertap.min.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(wzrk, s);
        }

        // Function to check localStorage and initialize CleverTap
        function initializeCleverTap() {
            var username = localStorage.getItem('username');
            if (username) {
                // Initialize CleverTap script
                loadCleverTapScript();
                window.clevertapInitialized = true;
            }
        }

        // Check localStorage and initialize CleverTap on page load
        window.onload = function() {
            initializeCleverTap();
        };
    </script>
</head>
<body>
    <div class="login-container">
        <h2>Login</h2>
        <form id="login-form" action="feature.html" onsubmit="handleLogin(event)">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit">Login</button>
        </form>
        <div class="form-group">
            <p>Don't have an account? <a href="signup.html">Sign Up</a></p>
        </div>
        <div class="form-group">
            <p>Go back to <a href="index.html">Home</a></p>
        </div>
    </div>

    <script>
        function handleLogin(event) {
            event.preventDefault(); // Prevent the form from submitting normally

            // Retrieve form data
            var username = document.getElementById('username').value;

            // Set localStorage with username
            localStorage.setItem('username', username);

            // Initialize CleverTap if not already initialized
            if (!window.clevertapInitialized) {
                loadCleverTapScript();
                window.clevertapInitialized = true;
            }

            // Push event to CleverTap
            clevertap.onUserLogin.push({
                "Site": {
                    "Identity": username,
                },
            });

            // Redirect to feature.html
            window.location.href = 'feature.html';
        }
    </script>
</body>
</html>
